.. _hcp_connectivity:

.. title:: Load connectivity data

Connectivity data
==================================================

This page contains descriptions and examples to use HCP connectivity data!
For details on HCP participants and data processing, please see our manuscript entitled 
`Network-based atrophy modelling in the common epilepsies: a worldwide ENIGMA study <https://www.biorxiv.org/content/10.1101/2020.05.04.076836v1>`_


.. _load_corticocortical:

Load cortical connectivity matrices
----------------------------------------
The **ENIGMA TOOLBOX** provides structural (diffusion MRI) and functional 
(resting-state functional MRI) connectivity matrices obtained from the Human Connectome Project (HCP). 

.. tabs::

   .. code-tab:: py
       
        >>> from enigmatoolbox.datasets import load_sc, load_fc
        >>> from nilearn import plotting

        >>> # Load cortico-cortical functional connectivity data
        >>> fc_ctx, fc_ctx_labels, _, _ = load_fc()
        
        >>> # Load cortico-cortical structural connectivity data
        >>> sc_ctx, sc_ctx_labels, _, _ = load_sc()

        >>> # Plot cortico-cortical connectivity matrices
        >>> fc_plot = plotting.plot_matrix(fc_ctx, figure=(9, 9), labels=fc_ctx_labels, vmax=0.8, vmin=0, cmap='Reds')
        >>> sc_plot = plotting.plot_matrix(sc_ctx, figure=(9, 9), labels=sc_ctx_labels, vmax=10, vmin=0, cmap='Blues')

   .. code-tab:: matlab

        % Load cortico-cortical functional connectivity data
        [fc_ctx, fc_ctx_labels, ~, ~] = load_fc();

        % Load cortico-cortical structural connectivity data
        [sc_ctx, sc_ctx_labels, ~, ~] = load_sc();

        % Plot cortico-cortical connectivity matrices
        f = figure,
          imagesc(fc_ctx, [0 0.8]);               
          colormap(Reds);                          
          colorbar;                                
          set(gca, 'YTick', 1:1:length(fc_ctx_labels), ...   
              'YTickLabel', fc_ctx_labels)         

        f = figure,
          imagesc(sc_ctx, [0 10]);                 
          colormap(Blues);                        
          colorbar;                               
          set(gca, 'YTick', 1:1:length(sc_ctx_labels), ...   
              'YTickLabel', sc_ctx_labels)        

.. image:: ./examples/example_figs/ctx_conn.png
    :align: center

Following the example below, we can also extract seed-based cortico-cortical connectivity, using the 
left middle temporal gyrus as example seed. 

.. tabs::

   .. code-tab:: py
       
        >>> # Extract seed-based connectivity
        >>> seed = "L_middletemporal"
        >>> seed_conn_fc = fc_ctx[[i for i, item in enumerate(fc_ctx_labels) if seed in item],]   
        >>> seed_conn_sc = sc_ctx[[i for i, item in enumerate(sc_ctx_labels) if seed in item],]   

   .. code-tab:: matlab

        % Extract seed-based connectivity
        seed = 'L_middletemporal'
        seed_conn_fc = fc_ctx(find(strcmp(fc_ctx_labels, seed)), :)  
        seed_conn_sc = sc_ctx(find(strcmp(sc_ctx_labels, seed)), :)   


|


.. _load_subcorticocortical:

Load subcortical connectivity matrices
-------------------------------------------
| Subcortico-cortical as well as subcortico-subcortical connectivity matrices are also included in the
 **ENIGMA TOOLBOX**! As above, we can load these structural and functional matrices and extract seed-based connectivity
 from subcortical seeds!

.. tabs::

   .. code-tab:: py

        >>> from enigmatoolbox.datasets import load_sc, load_fc
        >>> from nilearn import plotting

        >>> # Load subcortico-cortical functional connectivity data
        >>> _, _, fc_sctx, fc_sctx_labels = load_fc()

        >>> # Load subcortico-cortical structural connectivity data
        >>> _, _, sc_sctx, sc_sctx_labels = load_sc()

        >>> # Plot subcortico-cortical connectivity matrices
        >>> fc_plot = plotting.plot_matrix(fc_sctx, figure=(9, 9), labels=fc_sctx_labels, vmax=0.5, vmin=0, cmap='Reds')
        >>> sc_plot = plotting.plot_matrix(sc_sctx, figure=(9, 9), labels=sc_sctx_labels, vmax=10, vmin=0, cmap='Blues')

   .. code-tab:: matlab

        % Load subcortico-cortical functional connectivity data
        [~, ~, fc_sctx, fc_sctx_labels] = load_fc();

        % Load subcortico-cortical structural connectivity data
        [~, ~, sc_sctx, sc_sctx_labels] = load_sc();

        % Plot subcortico-cortical connectivity matrices 
        f = figure,
          imagesc(fc_sctx, [0 0.5]);               
          colormap(Reds);                          
          colorbar;                                
          set(gca, 'YTick', 1:1:length(fc_sctx_labels), ...   
              'YTickLabel', fc_sctx_labels)       

        f = figure,
          imagesc(sc_sctx, [0 10]);                
          colormap(Blues);                         
          colorbar;                                
          set(gca, 'YTick', 1:1:length(sc_sctx_labels), ...   
              'YTickLabel', sc_sctx_labels)       

.. image:: ./examples/example_figs/sctx_conn.png
    :align: center

As described above, we can also extract seed-based subcortico-cortical connectivity, using the left hippocampus 
as example seed. 

.. tabs::

   .. code-tab:: py

        >>> # Extract seed-based connectivity
        >>> seed = "Lhippo"
        >>> seed_conn_fc = fc_sctx[[i for i, item in enumerate(fc_sctx_labels) if seed in item],]   
        >>> seed_conn_sc = sc_sctx[[i for i, item in enumerate(sc_sctx_labels) if seed in item],] 

   .. code-tab:: matlab    

        % Extract seed-based connectivity
        seed = 'Lhippo'
        seed_conn_fc = fc_sctx(find(strcmp(fc_sctx_labels, seed)), :)   
        seed_conn_sc = sc_sctx(find(strcmp(sc_sctx_labels, seed)), :)   


.. image:: ./examples/example_figs/sctx_conn.png
    :align: center