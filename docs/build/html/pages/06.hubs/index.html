

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Hub susceptibility model &mdash; ENIGMA TOOLBOX  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/sphinx_tabs/semantic-ui-2.4.1/segment.min.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/sphinx_tabs/semantic-ui-2.4.1/menu.min.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/sphinx_tabs/semantic-ui-2.4.1/tab.min.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/sphinx_tabs/tabs.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/saratheriver_tabs.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/saratheriver_enigma.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/sphinx_tabs/semantic-ui-2.4.1/tab.min.js"></script>
        <script src="../../_static/sphinx_tabs/tabs.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Epicenter mapping" href="../07.epicenter/index.html" />
    <link rel="prev" title="Connectivity data" href="../05.HCP/index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #259595" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> ENIGMA TOOLBOX
          

          
          </a>

          
            
            
          

          <script type="text/javascript" src="../../static/js/copybutton.js"></script>

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../01.install/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02.01.tutorialsinstructions/index.html">Usage notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02.whatsnew/index.html">What’s new?</a></li>
</ul>
<p class="caption"><span class="caption-text">ENIGMA datasets</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../03.loadct/index.html">Individual site data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04.loadsumstats/index.html">Summary statistics</a></li>
</ul>
<p class="caption"><span class="caption-text">Network-based atrophy models</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../05.HCP/index.html">Connectivity data</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Hub susceptibility</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#cortical-hubs">Cortical hubs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#subcortical-hubs">Subcortical hubs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hub-atrophy-correlations">Hub-atrophy correlations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#spin-permutation-tests">Spin permutation tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="#plot-hub-atrophy-correlations">Plot hub-atrophy correlations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../07.epicenter/index.html">Epicenter mapping</a></li>
</ul>
<p class="caption"><span class="caption-text">Structural covariance networks</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../08.covariance/index.html">Structural covariance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../09.gt/index.html">Graph theory analyses</a></li>
</ul>
<p class="caption"><span class="caption-text">Gene expression</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../10.genemaps/index.html">Gene expression data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../11.epilepsygenes/index.html">Disease-related gene expression maps</a></li>
</ul>
<p class="caption"><span class="caption-text">Surface data visualization</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../12.visualization/index.html">Surface data visualization</a></li>
</ul>
<p class="caption"><span class="caption-text">References &amp; acknowledgements</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../13.01.apireference/index.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../13.citeus/index.html">Citing the ENIGMA TOOLBOX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../14.refs/index.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../15.funding/index.html">Acknowledgements</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">ENIGMA TOOLBOX</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Hub susceptibility model</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/pages/06.hubs/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="hub-susceptibility">
<span id="hubs-susceptibility"></span><h1>Hub susceptibility<a class="headerlink" href="#hub-susceptibility" title="Permalink to this headline">¶</a></h1>
<p>This page contains descriptions and examples to build hub susceptibility models!</p>
<div class="section" id="cortical-hubs">
<span id="id1"></span><h2>Cortical hubs<a class="headerlink" href="#cortical-hubs" title="Permalink to this headline">¶</a></h2>
<p>Using the <a class="reference internal" href="../05.HCP/index.html#hcp-connectivity"><span class="std std-ref">HCP connectivity data</span></a>, we can then compute weighted (optimal for unthresholded connectivity
matrices) degree centrality to identify structural and functional hub regions. This is done by simply
computing the sum of all weighted cortico-cortical connections for every region. Higher degree centrality
denotes increased hubness (<em>i.e.</em>, node with many connections).</p>
<pre class="literal-block"><strong>Prerequisites</strong>
↪ <a class="reference internal" href="../05.HCP/index.html#load-corticocortical"><span class="std std-ref">Load cortico-cortical connectivity matrices</span></a></pre>
<div class="sphinx-tabs docutils container">
<div class="ui top attached tabular menu sphinx-menu docutils container">
<div class="active item sphinx-data-tab-UHl0aG9u docutils container">
<div class="docutils container">
<p>Python</p>
</div>
</div>
<div class="item sphinx-data-tab-TWF0bGFi docutils container">
<div class="docutils container">
<p>Matlab</p>
</div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment code-tab sphinx-data-tab-UHl0aG9u active docutils container">
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">enigmatoolbox.plotting</span> <span class="kn">import</span> <span class="n">plot_cortical</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">enigmatoolbox.utils.parcellation</span> <span class="kn">import</span> <span class="n">parcel_to_surface</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute weighted degree centrality measures from the connectivity data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fc_ctx_dc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">fc_ctx</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc_ctx_dc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">sc_ctx</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Map parcellated data to the surface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fc_ctx_dc_fsa5</span> <span class="o">=</span> <span class="n">parcel_to_surface</span><span class="p">(</span><span class="n">fc_ctx_dc</span><span class="p">,</span> <span class="s1">&#39;aparc_fsa5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc_ctx_dc_fsa5</span> <span class="o">=</span> <span class="n">parcel_to_surface</span><span class="p">(</span><span class="n">sc_ctx_dc</span><span class="p">,</span> <span class="s1">&#39;aparc_fsa5&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Project the results on the surface brain</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_cortical</span><span class="p">(</span><span class="n">array_name</span><span class="o">=</span><span class="n">fc_ctx_dc_fsa5</span><span class="p">,</span> <span class="n">surface_name</span><span class="o">=</span><span class="s2">&quot;fsa5&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">400</span><span class="p">),</span>
<span class="gp">... </span>              <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">,</span> <span class="n">color_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color_range</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_cortical</span><span class="p">(</span><span class="n">array_name</span><span class="o">=</span><span class="n">sc_ctx_dc_fsa5</span><span class="p">,</span> <span class="n">surface_name</span><span class="o">=</span><span class="s2">&quot;fsa5&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">400</span><span class="p">),</span>
<span class="gp">... </span>              <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="n">color_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color_range</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">300</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment code-tab sphinx-data-tab-TWF0bGFi docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Compute weighted degree centrality measures from the connectivity data</span>
<span class="n">fc_ctx_dc</span>           <span class="s">=</span> <span class="s">sum(fc_ctx)</span><span class="p">;</span>
<span class="n">sc_ctx_dc</span>           <span class="s">=</span> <span class="s">sum(sc_ctx)</span><span class="p">;</span>

<span class="c">% Map parcellated data to the surface</span>
<span class="n">fc_ctx_dc_fsa5</span>      <span class="s">=</span> <span class="s">parcel_to_surface(fc_ctx_dc,</span> <span class="s">&#39;aparc_fsa5&#39;)</span><span class="p">;</span>
<span class="n">sc_ctx_dc_fsa5</span>      <span class="s">=</span> <span class="s">parcel_to_surface(sc_ctx_dc,</span> <span class="s">&#39;aparc_fsa5&#39;)</span><span class="p">;</span>

<span class="c">% Project the results on the surface brain</span>
<span class="n">f</span> <span class="p">=</span> <span class="n">figure</span><span class="p">,</span>
  <span class="n">plot_cortical</span><span class="p">(</span><span class="n">fc_ctx_dc_fsa5</span><span class="p">,</span> <span class="s">&#39;surface_name&#39;</span><span class="p">,</span> <span class="s">&#39;fsa5&#39;</span><span class="p">,</span> <span class="s">&#39;color_range&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">20</span> <span class="mi">30</span><span class="p">],</span> <span class="c">...</span>
                <span class="s">&#39;cmap&#39;</span><span class="p">,</span> <span class="s">&#39;Reds&#39;</span><span class="p">,</span> <span class="s">&#39;label_text&#39;</span><span class="p">,</span> <span class="s">&#39;Functional degree centrality&#39;</span><span class="p">)</span>

<span class="n">f</span> <span class="p">=</span> <span class="n">figure</span><span class="p">,</span>
  <span class="n">plot_cortical</span><span class="p">(</span><span class="n">sc_ctx_dc_fsa5</span><span class="p">,</span> <span class="s">&#39;surface_name&#39;</span><span class="p">,</span> <span class="s">&#39;fsa5&#39;</span><span class="p">,</span> <span class="s">&#39;color_range&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span> <span class="mi">300</span><span class="p">],</span> <span class="c">...</span>
                <span class="s">&#39;cmap&#39;</span><span class="p">,</span> <span class="s">&#39;Blues&#39;</span><span class="p">,</span> <span class="s">&#39;label_text&#39;</span><span class="p">,</span> <span class="s">&#39;Structural degree centrality&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<img alt="../../_images/hubs_ctx.png" class="align-center" src="../../_images/hubs_ctx.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="subcortical-hubs">
<span id="id2"></span><h2>Subcortical hubs<a class="headerlink" href="#subcortical-hubs" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="../12.visualization/index.html#surf-visualization"><span class="std std-ref">HCP connectivity data</span></a> can also be used to identify structural
and functional subcortico-cortical hub regions. As above, we simply compute the sum of all weighted
subcortico-cortical connections for every subcortical area. Once again, higher degree centrality
denotes increased hubness!</p>
<div class="admonition-no-ventricles-no-problem admonition">
<p class="admonition-title">No ventricles, no problem 👌🏼</p>
<p>Because we do not have connectivity values for the ventricles, do make sure to set
the “ventricles” flag to <code class="docutils literal notranslate"><span class="pre">False</span></code> when displaying the findings on the subcortical surfaces!</p>
</div>
<pre class="literal-block"><strong>Prerequisites</strong>
↪ <a class="reference internal" href="../05.HCP/index.html#load-subcorticocortical"><span class="std std-ref">Load subcortico-cortical connectivity matrices</span></a></pre>
<div class="sphinx-tabs docutils container">
<div class="ui top attached tabular menu sphinx-menu docutils container">
<div class="active item sphinx-data-tab-UHl0aG9u docutils container">
<div class="docutils container">
<p>Python</p>
</div>
</div>
<div class="item sphinx-data-tab-TWF0bGFi docutils container">
<div class="docutils container">
<p>Matlab</p>
</div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment code-tab sphinx-data-tab-UHl0aG9u active docutils container">
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">enigmatoolbox.plotting</span> <span class="kn">import</span> <span class="n">plot_subcortical</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute weighted degree centrality measures from the connectivity data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fc_sctx_dc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">fc_sctx</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc_sctx_dc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">sc_sctx</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Project the results on the surface brain</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_subcortical</span><span class="p">(</span><span class="n">array_name</span><span class="o">=</span><span class="n">fc_sctx_dc</span><span class="p">,</span> <span class="n">ventricles</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">400</span><span class="p">),</span>
<span class="gp">... </span>                 <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">,</span> <span class="n">color_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color_range</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_subcortical</span><span class="p">(</span><span class="n">array_name</span><span class="o">=</span><span class="n">sc_sctx_dc</span><span class="p">,</span> <span class="n">ventricles</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">400</span><span class="p">),</span>
<span class="gp">... </span>                 <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="n">color_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color_range</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">300</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment code-tab sphinx-data-tab-TWF0bGFi docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Compute weighted degree centrality measures from the connectivity data</span>
<span class="n">fc_sctx_dc</span>          <span class="s">=</span> <span class="s">sum(fc_sctx,</span> <span class="s">2)</span><span class="p">;</span>
<span class="n">sc_sctx_dc</span>          <span class="s">=</span> <span class="s">sum(sc_sctx,</span> <span class="s">2)</span><span class="p">;</span>

<span class="c">% Project the results on the surface brain</span>
<span class="n">f</span> <span class="p">=</span> <span class="n">figure</span><span class="p">,</span>
  <span class="n">plot_subcortical</span><span class="p">(</span><span class="n">fc_sctx_dc</span><span class="p">,</span> <span class="s">&#39;ventricles&#39;</span><span class="p">,</span> <span class="s">&#39;False&#39;</span><span class="p">,</span> <span class="s">&#39;color_range&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span> <span class="mi">10</span><span class="p">],</span> <span class="c">...</span>
                   <span class="s">&#39;cmap&#39;</span><span class="p">,</span> <span class="s">&#39;Reds&#39;</span><span class="p">,</span> <span class="s">&#39;label_text&#39;</span><span class="p">,</span> <span class="s">&#39;Functional degree centrality&#39;</span><span class="p">)</span>

<span class="n">f</span> <span class="p">=</span> <span class="n">figure</span><span class="p">,</span>
  <span class="n">plot_subcortical</span><span class="p">(</span><span class="n">sc_sctx_dc</span><span class="p">,</span> <span class="s">&#39;ventricles&#39;</span><span class="p">,</span> <span class="s">&#39;False&#39;</span><span class="p">,</span> <span class="s">&#39;color_range&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span> <span class="mi">300</span><span class="p">],</span> <span class="c">...</span>
                   <span class="s">&#39;cmap&#39;</span><span class="p">,</span> <span class="s">&#39;Blues&#39;</span><span class="p">,</span> <span class="s">&#39;label_text&#39;</span><span class="p">,</span> <span class="s">&#39;Structural degree centrality&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<img alt="../../_images/hubs_sctx.png" class="align-center" src="../../_images/hubs_sctx.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="hub-atrophy-correlations">
<h2>Hub-atrophy correlations<a class="headerlink" href="#hub-atrophy-correlations" title="Permalink to this headline">¶</a></h2>
<p>Now that we have established the spatial distribution of hubs in the brain, we can then assess
whether there is a selective vulnerability of these hub regions that parallels syndrome-specific atrophy patterns.
For simplicity, in the following example, we will spatially correlate degree centrality measures to measures of
cortical and subcortical atrophy (where lower values indicating greater atrophy relative to controls).</p>
<pre class="literal-block"><strong>Prerequisites</strong>
↪ Load <a class="reference internal" href="../04.loadsumstats/index.html#load-sumstats"><span class="std std-ref">summary statistics</span></a> <strong>or</strong> <a class="reference internal" href="../03.loadct/index.html#load-example-data"><span class="std std-ref">example data</span></a>
↪ <a class="reference internal" href="../03.loadct/index.html#reorder-sctx"><span class="std std-ref">Re-order subcortical data</span></a> (<em>mega only</em>)
↪ <a class="reference internal" href="../03.loadct/index.html#zscore-data"><span class="std std-ref">Z-score data</span></a> (<em>mega only</em>)
↪ Load <a class="reference internal" href="../05.HCP/index.html#load-corticocortical"><span class="std std-ref">cortico-cortical</span></a> and <a class="reference internal" href="../05.HCP/index.html#load-subcorticocortical"><span class="std std-ref">subcortico-cortical</span></a> connectivity matrices
↪ Compute <a class="reference internal" href="#cortical-hubs"><span class="std std-ref">cortical-cortical</span></a> and <a class="reference internal" href="#subcortical-hubs"><span class="std std-ref">subcortico-cortical</span></a> degree centrality</pre>
<div class="sphinx-tabs docutils container">
<div class="ui top attached tabular menu sphinx-menu docutils container">
<div class="active item sphinx-data-tab-KipQeXRob24qKiB8IG1ldGE= docutils container">
<div class="docutils container">
<p><strong>Python</strong> | meta</p>
</div>
</div>
<div class="item sphinx-data-tab-KipNYXRsYWIqKiB8IG1ldGE= docutils container">
<div class="docutils container">
<p><strong>Matlab</strong> | meta</p>
</div>
</div>
<div class="item sphinx-data-tab-2-0 docutils container">
<div class="docutils container">
<p>⤎ ⤏</p>
</div>
</div>
<div class="item sphinx-data-tab-KipQeXRob24qKiB8IG1lZ2E= docutils container">
<div class="docutils container">
<p><strong>Python</strong> | mega</p>
</div>
</div>
<div class="item sphinx-data-tab-KipNYXRsYWIqKiB8IG1lZ2E= docutils container">
<div class="docutils container">
<p><strong>Matlab</strong> | mega</p>
</div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment code-tab sphinx-data-tab-KipQeXRob24qKiB8IG1ldGE= active docutils container">
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Remove subcortical values corresponding to the ventricles</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># (as we don&#39;t have connectivity values for them!)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">SV_d_noVent</span> <span class="o">=</span> <span class="n">SV_d</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">SV</span><span class="p">[</span><span class="s1">&#39;Structure&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;LLatVent&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                        <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">SV</span><span class="p">[</span><span class="s1">&#39;Structure&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;RLatVent&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Perform spatial correlations between functional hubs and Cohen&#39;s d</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fc_ctx_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">fc_ctx_dc</span><span class="p">,</span> <span class="n">CT_d</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fc_sctx_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">fc_sctx_dc</span><span class="p">,</span> <span class="n">SV_d_noVent</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Perform spatial correlations between structural hubs and Cohen&#39;s d</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc_ctx_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">sc_ctx_dc</span><span class="p">,</span> <span class="n">CT_d</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc_sctx_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">sc_sctx_dc</span><span class="p">,</span> <span class="n">SV_d_noVent</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Store correlation coefficients</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rvals</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;functional cortical hubs&#39;</span><span class="p">:</span> <span class="n">fc_ctx_r</span><span class="p">,</span> <span class="s1">&#39;functional subcortical hubs&#39;</span><span class="p">:</span> <span class="n">fc_sctx_r</span><span class="p">,</span>
<span class="gp">... </span>         <span class="s1">&#39;structural cortical hubs&#39;</span><span class="p">:</span> <span class="n">sc_ctx_r</span><span class="p">,</span> <span class="s1">&#39;structural subcortical hubs&#39;</span><span class="p">:</span> <span class="n">sc_sctx_r</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment code-tab sphinx-data-tab-KipNYXRsYWIqKiB8IG1ldGE= docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Remove subcortical values corresponding the ventricles</span>
<span class="c">% (as we don&#39;t have connectivity values for them!)</span>
<span class="n">SV_d_noVent</span> <span class="p">=</span> <span class="n">SV_d</span><span class="p">;</span>
<span class="n">SV_d_noVent</span><span class="p">([</span><span class="nb">find</span><span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="n">SV</span><span class="p">.</span><span class="n">Structure</span><span class="p">,</span> <span class="s">&#39;LLatVent&#39;</span><span class="p">));</span> <span class="c">...</span>
            <span class="nb">find</span><span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="n">SV</span><span class="p">.</span><span class="n">Structure</span><span class="p">,</span> <span class="s">&#39;RLatVent&#39;</span><span class="p">))],</span> <span class="p">:)</span> <span class="p">=</span> <span class="p">[];</span>

<span class="c">% Perform spatial correlations between cortical hubs and Cohen&#39;s d</span>
<span class="n">fc_ctx_r</span> <span class="p">=</span> <span class="n">corrcoef</span><span class="p">(</span><span class="n">fc_ctx_dc</span><span class="p">,</span> <span class="n">CT_d</span><span class="p">);</span>
<span class="n">sc_ctx_r</span> <span class="p">=</span> <span class="n">corrcoef</span><span class="p">(</span><span class="n">sc_ctx_dc</span><span class="p">,</span> <span class="n">CT_d</span><span class="p">);</span>

<span class="c">% Perform spatial correlations between structural hubs and Cohen&#39;s d</span>
<span class="n">fc_sctx_r</span> <span class="p">=</span> <span class="n">corrcoef</span><span class="p">(</span><span class="n">fc_sctx_dc</span><span class="p">,</span> <span class="n">SV_d_noVent</span><span class="p">);</span>
<span class="n">sc_sctx_r</span> <span class="p">=</span> <span class="n">corrcoef</span><span class="p">(</span><span class="n">sc_sctx_dc</span><span class="p">,</span> <span class="n">SV_d_noVent</span><span class="p">);</span>

<span class="c">% Store correlation coefficients</span>
<span class="n">rvals</span> <span class="p">=</span> <span class="n">cell2struct</span><span class="p">({</span><span class="n">fc_ctx_r</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">fc_sctx_r</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">sc_ctx_r</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">sc_sctx_r</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)},</span> <span class="c">...</span>
                    <span class="p">{</span><span class="s">&#39;functional_cortical_hubs&#39;</span><span class="p">,</span> <span class="s">&#39;functional_subcortical_hubs&#39;</span><span class="p">,</span> <span class="c">...</span>
                     <span class="s">&#39;structural_cortical_hubs&#39;</span><span class="p">,</span> <span class="s">&#39;structural_subcortical_hubs&#39;</span><span class="p">},</span> <span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment sphinx-data-tab-2-0 docutils container">
<div class="line-block">
<div class="line">⤎ If you have <strong>meta</strong>-analysis data (<em>e.g.</em>, summary statistics)</div>
<div class="line">⤏ If you have individual site or <strong>mega</strong>-analysis data</div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment code-tab sphinx-data-tab-KipQeXRob24qKiB8IG1lZ2E= docutils container">
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Remove subcortical values corresponding to the ventricles</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># (as we don&#39;t have connectivity values for them!)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">SV_z_mean_noVent</span> <span class="o">=</span> <span class="n">SV_z_mean</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;LLatVent&#39;</span><span class="p">,</span> <span class="s1">&#39;RLatVent&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Perform spatial correlations between functional hubs and z-scores</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fc_ctx_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">fc_ctx_dc</span><span class="p">,</span> <span class="n">CT_z_mean</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fc_sctx_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">fc_sctx_dc</span><span class="p">,</span> <span class="n">SV_z_mean_noVent</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Perform spatial correlations between structural hubs and z-scores</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc_ctx_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">sc_ctx_dc</span><span class="p">,</span> <span class="n">CT_z_mean</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc_sctx_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">sc_sctx_dc</span><span class="p">,</span> <span class="n">SV_z_mean_noVent</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Store correlation coefficients</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rvals</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;functional cortical hubs&#39;</span><span class="p">:</span> <span class="n">fc_ctx_r</span><span class="p">,</span> <span class="s1">&#39;functional subcortical hubs&#39;</span><span class="p">:</span> <span class="n">fc_sctx_r</span><span class="p">,</span>
<span class="gp">... </span>         <span class="s1">&#39;structural cortical hubs&#39;</span><span class="p">:</span> <span class="n">sc_ctx_r</span><span class="p">,</span> <span class="s1">&#39;structural subcortical hubs&#39;</span><span class="p">:</span> <span class="n">sc_sctx_r</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment code-tab sphinx-data-tab-KipNYXRsYWIqKiB8IG1lZ2E= docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Remove subcortical values corresponding the ventricles</span>
<span class="c">% (as we don&#39;t have connectivity values for them!)</span>
<span class="n">SV_z_mean_noVent</span> <span class="p">=</span> <span class="n">SV_z_mean</span><span class="p">;</span>
<span class="n">SV_z_mean_noVent</span><span class="p">.</span><span class="n">LLatVent</span> <span class="p">=</span> <span class="p">[];</span>
<span class="n">SV_z_mean_noVent</span><span class="p">.</span><span class="n">RLatVent</span> <span class="p">=</span> <span class="p">[];</span>

<span class="c">% Perform spatial correlations between cortical hubs and Cohen&#39;s d</span>
<span class="n">fc_ctx_r</span> <span class="p">=</span> <span class="n">corrcoef</span><span class="p">(</span><span class="n">fc_ctx_dc</span><span class="p">,</span> <span class="n">CT_z_mean</span><span class="p">{:,</span> <span class="p">:});</span>
<span class="n">sc_ctx_r</span> <span class="p">=</span> <span class="n">corrcoef</span><span class="p">(</span><span class="n">sc_ctx_dc</span><span class="p">,</span> <span class="n">CT_z_mean</span><span class="p">{:,</span> <span class="p">:});</span>

<span class="c">% Perform spatial correlations between structural hubs and Cohen&#39;s d</span>
<span class="n">fc_sctx_r</span> <span class="p">=</span> <span class="n">corrcoef</span><span class="p">(</span><span class="n">fc_sctx_dc</span><span class="p">,</span> <span class="n">SV_z_mean_noVent</span><span class="p">{:,</span> <span class="p">:});</span>
<span class="n">sc_sctx_r</span> <span class="p">=</span> <span class="n">corrcoef</span><span class="p">(</span><span class="n">sc_sctx_dc</span><span class="p">,</span> <span class="n">SV_z_mean_noVent</span><span class="p">{:,</span> <span class="p">:});</span>

<span class="c">% Store correlation coefficients</span>
<span class="n">rvals</span> <span class="p">=</span> <span class="n">cell2struct</span><span class="p">({</span><span class="n">fc_ctx_r</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">fc_sctx_r</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">sc_ctx_r</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">sc_sctx_r</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)},</span> <span class="c">...</span>
                    <span class="p">{</span><span class="s">&#39;functional_cortical_hubs&#39;</span><span class="p">,</span> <span class="s">&#39;functional_subcortical_hubs&#39;</span><span class="p">,</span> <span class="c">...</span>
                     <span class="s">&#39;structural_cortical_hubs&#39;</span><span class="p">,</span> <span class="s">&#39;structural_subcortical_hubs&#39;</span><span class="p">},</span> <span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="spin-permutation-tests">
<span id="spin-perm"></span><h2>Spin permutation tests<a class="headerlink" href="#spin-permutation-tests" title="Permalink to this headline">¶</a></h2>
<p>The intrinsic spatial smoothness in two given <strong>cortical maps</strong> may inflate the significance of their spatial correlation.
To overcome this challenge, we assess statistical significance using <em>spin permutation tests</em>.
To do so, we generate null models of overlap between cortical maps by projecting the spatial
coordinates of cortical data onto the surface spheres, apply randomly sampled rotations,
and reassign cortical values. We then compare the original correlation coefficients against
the empirical distribution determined by the ensemble of spatially permuted correlation coefficients.</p>
<div class="line-block">
<div class="line">To compare spatial overlap between <strong>subcortical maps</strong>, we employed a similar approach with the exception
that subcortical labels were randomly shuffled as opposed to being projected onto spheres.</div>
</div>
<pre class="literal-block"><strong>Prerequisites</strong>
Two brain maps from which you want to assess the signifcance of their correlations, as for example:
degree centrality <em>vs</em>. atrophy
     ↪ Load <a class="reference internal" href="../04.loadsumstats/index.html#load-sumstats"><span class="std std-ref">summary statistics</span></a> <strong>or</strong> <a class="reference internal" href="../03.loadct/index.html#load-example-data"><span class="std std-ref">example data</span></a>
     ↪ <a class="reference internal" href="../03.loadct/index.html#reorder-sctx"><span class="std std-ref">Re-order subcortical data</span></a> (<em>mega only</em>)
     ↪ <a class="reference internal" href="../03.loadct/index.html#zscore-data"><span class="std std-ref">Z-score data</span></a> (<em>mega only</em>)
     ↪ Load <a class="reference internal" href="../05.HCP/index.html#load-corticocortical"><span class="std std-ref">cortico-cortical</span></a> and <a class="reference internal" href="../05.HCP/index.html#load-subcorticocortical"><span class="std std-ref">subcortico-cortical</span></a> connectivity matrices
     ↪ Compute <a class="reference internal" href="#cortical-hubs"><span class="std std-ref">cortical-cortical</span></a> and <a class="reference internal" href="#subcortical-hubs"><span class="std std-ref">subcortico-cortical</span></a> degree centrality</pre>
<div class="sphinx-tabs docutils container">
<div class="ui top attached tabular menu sphinx-menu docutils container">
<div class="active item sphinx-data-tab-KipQeXRob24qKiB8IG1ldGE= docutils container">
<div class="docutils container">
<p><strong>Python</strong> | meta</p>
</div>
</div>
<div class="item sphinx-data-tab-KipNYXRsYWIqKiB8IG1ldGE= docutils container">
<div class="docutils container">
<p><strong>Matlab</strong> | meta</p>
</div>
</div>
<div class="item sphinx-data-tab-3-0 docutils container">
<div class="docutils container">
<p>⤎ ⤏</p>
</div>
</div>
<div class="item sphinx-data-tab-KipQeXRob24qKiB8IG1lZ2E= docutils container">
<div class="docutils container">
<p><strong>Python</strong> | mega</p>
</div>
</div>
<div class="item sphinx-data-tab-KipNYXRsYWIqKiB8IG1lZ2E= docutils container">
<div class="docutils container">
<p><strong>Matlab</strong> | mega</p>
</div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment code-tab sphinx-data-tab-KipQeXRob24qKiB8IG1ldGE= active docutils container">
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">enigmatoolbox.permutation_testing</span> <span class="kn">import</span> <span class="n">spin_test</span><span class="p">,</span> <span class="n">shuf_test</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Remove subcortical values corresponding to the ventricles</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># (as we don&#39;t have connectivity values for them!)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">SV_d_noVent</span> <span class="o">=</span> <span class="n">SV_d</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">SV</span><span class="p">[</span><span class="s1">&#39;Structure&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;LLatVent&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                        <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">SV</span><span class="p">[</span><span class="s1">&#39;Structure&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;RLatVent&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spin permutation testing for two cortical maps</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fc_ctx_p</span><span class="p">,</span> <span class="n">fc_ctx_d</span> <span class="o">=</span> <span class="n">spin_test</span><span class="p">(</span><span class="n">fc_ctx_dc</span><span class="p">,</span> <span class="n">CT_d</span><span class="p">,</span> <span class="n">surface_name</span><span class="o">=</span><span class="s1">&#39;fsa5&#39;</span><span class="p">,</span> <span class="n">parcellation_name</span><span class="o">=</span><span class="s1">&#39;aparc&#39;</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;pearson&#39;</span><span class="p">,</span> <span class="n">n_rot</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">spin_dist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc_ctx_p</span><span class="p">,</span> <span class="n">sc_ctx_d</span> <span class="o">=</span> <span class="n">spin_test</span><span class="p">(</span><span class="n">sc_ctx_dc</span><span class="p">,</span> <span class="n">CT_d</span><span class="p">,</span> <span class="n">surface_name</span><span class="o">=</span><span class="s1">&#39;fsa5&#39;</span><span class="p">,</span> <span class="n">parcellation_name</span><span class="o">=</span><span class="s1">&#39;aparc&#39;</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;pearson&#39;</span><span class="p">,</span> <span class="n">n_rot</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">spin_dist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Shuf permutation testing for two subcortical maps</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fc_sctx_p</span><span class="p">,</span> <span class="n">fc_sctx_d</span> <span class="o">=</span> <span class="n">shuf_test</span><span class="p">(</span><span class="n">fc_sctx_dc</span><span class="p">,</span> <span class="n">SV_d_noVent</span><span class="p">,</span> <span class="n">n_rot</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
<span class="gp">... </span>                                 <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;pearson&#39;</span><span class="p">,</span> <span class="n">spin_dist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc_sctx_p</span><span class="p">,</span> <span class="n">sc_sctx_d</span> <span class="o">=</span> <span class="n">shuf_test</span><span class="p">(</span><span class="n">sc_sctx_dc</span><span class="p">,</span> <span class="n">SV_d_noVent</span><span class="p">,</span> <span class="n">n_rot</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
<span class="gp">... </span>                                 <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;pearson&#39;</span><span class="p">,</span> <span class="n">spin_dist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Store p-values and null distributions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p_and_d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;functional cortical hubs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">fc_ctx_p</span><span class="p">,</span> <span class="n">fc_ctx_d</span><span class="p">],</span> <span class="s1">&#39;functional subcortical hubs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">fc_sctx_p</span><span class="p">,</span> <span class="n">fc_sctx_d</span><span class="p">],</span>
<span class="gp">... </span>           <span class="s1">&#39;structural cortical hubs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">sc_ctx_p</span><span class="p">,</span> <span class="n">sc_ctx_d</span><span class="p">],</span> <span class="s1">&#39;structural subcortical hubs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">sc_sctx_p</span><span class="p">,</span> <span class="n">sc_sctx_d</span><span class="p">]}</span>
</pre></div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment code-tab sphinx-data-tab-KipNYXRsYWIqKiB8IG1ldGE= docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Remove subcortical values corresponding to the ventricles</span>
<span class="c">% (as we don&#39;t have connectivity values for them!)</span>
<span class="n">SV_d_noVent</span> <span class="p">=</span> <span class="n">SV_d</span><span class="p">;</span>
<span class="n">SV_d_noVent</span><span class="p">([</span><span class="nb">find</span><span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="n">SV</span><span class="p">.</span><span class="n">Structure</span><span class="p">,</span> <span class="s">&#39;LLatVent&#39;</span><span class="p">));</span> <span class="c">...</span>
            <span class="nb">find</span><span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="n">SV</span><span class="p">.</span><span class="n">Structure</span><span class="p">,</span> <span class="s">&#39;RLatVent&#39;</span><span class="p">))],</span> <span class="p">:)</span> <span class="p">=</span> <span class="p">[];</span>

<span class="c">% Spin permutation testing for two cortical maps</span>
<span class="p">[</span><span class="n">fc_ctx_p</span><span class="p">,</span> <span class="n">fc_ctx_d</span><span class="p">]</span>   <span class="p">=</span> <span class="n">spin_test</span><span class="p">(</span><span class="n">fc_ctx_dc</span><span class="p">,</span> <span class="n">CT_d</span><span class="p">,</span> <span class="s">&#39;surface_name&#39;</span><span class="p">,</span> <span class="s">&#39;fsa5&#39;</span><span class="p">,</span> <span class="c">...</span>
                                   <span class="s">&#39;parcellation_name&#39;</span><span class="p">,</span> <span class="s">&#39;aparc&#39;</span><span class="p">,</span> <span class="s">&#39;n_rot&#39;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="c">...</span>
                                   <span class="s">&#39;type&#39;</span><span class="p">,</span> <span class="s">&#39;pearson&#39;</span><span class="p">);</span>
<span class="p">[</span><span class="n">sc_ctx_p</span><span class="p">,</span> <span class="n">sc_ctx_d</span><span class="p">]</span>   <span class="p">=</span> <span class="n">spin_test</span><span class="p">(</span><span class="n">sc_ctx_dc</span><span class="p">,</span> <span class="n">CT_d</span><span class="p">,</span> <span class="s">&#39;surface_name&#39;</span><span class="p">,</span> <span class="s">&#39;fsa5&#39;</span><span class="p">,</span> <span class="c">...</span>
                                   <span class="s">&#39;parcellation_name&#39;</span><span class="p">,</span> <span class="s">&#39;aparc&#39;</span><span class="p">,</span> <span class="s">&#39;n_rot&#39;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="c">...</span>
                                   <span class="s">&#39;type&#39;</span><span class="p">,</span> <span class="s">&#39;pearson&#39;</span><span class="p">);</span>

<span class="c">% Shuf permutation testing for two subcortical maps</span>
<span class="p">[</span><span class="n">fc_sctx_p</span><span class="p">,</span> <span class="n">fc_sctx_d</span><span class="p">]</span> <span class="p">=</span> <span class="n">shuf_test</span><span class="p">(</span><span class="n">fc_sctx_dc</span><span class="p">,</span> <span class="n">SV_d_noVent</span><span class="p">,</span> <span class="c">...</span>
                                   <span class="s">&#39;n_rot&#39;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="s">&#39;type&#39;</span><span class="p">,</span> <span class="s">&#39;pearson&#39;</span><span class="p">);</span>
<span class="p">[</span><span class="n">sc_sctx_p</span><span class="p">,</span> <span class="n">sc_sctx_d</span><span class="p">]</span> <span class="p">=</span> <span class="n">shuf_test</span><span class="p">(</span><span class="n">sc_sctx_dc</span><span class="p">,</span> <span class="n">SV_d_noVent</span><span class="p">,</span> <span class="c">...</span>
                                   <span class="s">&#39;n_rot&#39;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="s">&#39;type&#39;</span><span class="p">,</span> <span class="s">&#39;pearson&#39;</span><span class="p">);</span>

<span class="c">% Store p-values and null distributions</span>
<span class="n">p_and_d</span> <span class="p">=</span>  <span class="n">cell2struct</span><span class="p">({[</span><span class="n">fc_ctx_p</span><span class="p">;</span> <span class="n">fc_ctx_d</span><span class="p">],</span> <span class="p">[</span><span class="n">fc_sctx_p</span><span class="p">;</span> <span class="n">fc_sctx_d</span><span class="p">],</span> <span class="p">[</span><span class="n">sc_ctx_p</span><span class="p">;</span> <span class="n">sc_ctx_d</span><span class="p">],</span> <span class="p">[</span><span class="n">sc_sctx_p</span><span class="p">;</span> <span class="n">sc_sctx_d</span><span class="p">]},</span> <span class="c">...</span>
                       <span class="p">{</span><span class="s">&#39;functional_cortical_hubs&#39;</span><span class="p">,</span> <span class="s">&#39;functional_subcortical_hubs&#39;</span><span class="p">,</span> <span class="c">...</span>
                        <span class="s">&#39;structural_cortical_hubs&#39;</span><span class="p">,</span> <span class="s">&#39;structural_subcortical_hubs&#39;</span><span class="p">},</span> <span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment sphinx-data-tab-3-0 docutils container">
<div class="line-block">
<div class="line">⤎ If you have <strong>meta</strong>-analysis data (<em>e.g.</em>, summary statistics)</div>
<div class="line">⤏ If you have individual site or <strong>mega</strong>-analysis data</div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment code-tab sphinx-data-tab-KipQeXRob24qKiB8IG1lZ2E= docutils container">
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">enigmatoolbox.permutation_testing</span> <span class="kn">import</span> <span class="n">spin_test</span><span class="p">,</span> <span class="n">shuf_test</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Remove subcortical values corresponding to the ventricles</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># (as we don&#39;t have connectivity values for them!)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">SV_z_mean_noVent</span> <span class="o">=</span> <span class="n">SV_z_mean</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;LLatVent&#39;</span><span class="p">,</span> <span class="s1">&#39;RLatVent&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spin permutation testing for two cortical maps</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fc_ctx_p</span><span class="p">,</span> <span class="n">fc_ctx_d</span> <span class="o">=</span> <span class="n">spin_test</span><span class="p">(</span><span class="n">fc_ctx_dc</span><span class="p">,</span> <span class="n">CT_z_mean</span><span class="p">,</span> <span class="n">surface_name</span><span class="o">=</span><span class="s1">&#39;fsa5&#39;</span><span class="p">,</span> <span class="n">parcellation_name</span><span class="o">=</span><span class="s1">&#39;aparc&#39;</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;pearson&#39;</span><span class="p">,</span> <span class="n">n_rot</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">spin_dist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc_ctx_p</span><span class="p">,</span> <span class="n">sc_ctx_d</span> <span class="o">=</span> <span class="n">spin_test</span><span class="p">(</span><span class="n">sc_ctx_dc</span><span class="p">,</span> <span class="n">CT_z_mean</span><span class="p">,</span> <span class="n">surface_name</span><span class="o">=</span><span class="s1">&#39;fsa5&#39;</span><span class="p">,</span> <span class="n">parcellation_name</span><span class="o">=</span><span class="s1">&#39;aparc&#39;</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;pearson&#39;</span><span class="p">,</span> <span class="n">n_rot</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">spin_dist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Shuf permutation testing for two subcortical maps</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fc_sctx_p</span><span class="p">,</span> <span class="n">fc_sctx_d</span> <span class="o">=</span> <span class="n">shuf_test</span><span class="p">(</span><span class="n">fc_sctx_dc</span><span class="p">,</span> <span class="n">SV_z_mean_noVent</span><span class="p">,</span> <span class="n">n_rot</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
<span class="gp">... </span>                                 <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;pearson&#39;</span><span class="p">,</span> <span class="n">spin_dist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc_sctx_p</span><span class="p">,</span> <span class="n">sc_sctx_d</span> <span class="o">=</span> <span class="n">shuf_test</span><span class="p">(</span><span class="n">sc_sctx_dc</span><span class="p">,</span> <span class="n">SV_z_mean_noVent</span><span class="p">,</span> <span class="n">n_rot</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
<span class="gp">... </span>                                 <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;pearson&#39;</span><span class="p">,</span> <span class="n">spin_dist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Store p-values and null distributions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p_and_d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;functional cortical hubs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">fc_ctx_p</span><span class="p">,</span> <span class="n">fc_ctx_d</span><span class="p">],</span> <span class="s1">&#39;functional subcortical hubs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">fc_sctx_p</span><span class="p">,</span> <span class="n">fc_sctx_d</span><span class="p">],</span>
<span class="gp">... </span>           <span class="s1">&#39;structural cortical hubs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">sc_ctx_p</span><span class="p">,</span> <span class="n">sc_ctx_d</span><span class="p">],</span> <span class="s1">&#39;structural subcortical hubs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">sc_sctx_p</span><span class="p">,</span> <span class="n">sc_sctx_d</span><span class="p">]}</span>
</pre></div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment code-tab sphinx-data-tab-KipNYXRsYWIqKiB8IG1lZ2E= docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Remove subcortical values corresponding to the ventricles</span>
<span class="c">% (as we don&#39;t have connectivity values for them!)</span>
<span class="n">SV_z_mean_noVent</span> <span class="p">=</span> <span class="n">SV_z_mean</span><span class="p">;</span>
<span class="n">SV_z_mean_noVent</span><span class="p">.</span><span class="n">LLatVent</span> <span class="p">=</span> <span class="p">[];</span>
<span class="n">SV_z_mean_noVent</span><span class="p">.</span><span class="n">RLatVent</span> <span class="p">=</span> <span class="p">[];</span>

<span class="c">% Spin permutation testing for two cortical maps</span>
<span class="p">[</span><span class="n">fc_ctx_p</span><span class="p">,</span> <span class="n">fc_ctx_d</span><span class="p">]</span>   <span class="p">=</span> <span class="n">spin_test</span><span class="p">(</span><span class="n">fc_ctx_dc</span><span class="p">,</span> <span class="n">CT_z_mean</span><span class="p">{:,</span> <span class="p">:},</span> <span class="s">&#39;surface_name&#39;</span><span class="p">,</span> <span class="c">...</span>
                                   <span class="s">&#39;fsa5&#39;</span><span class="p">,</span> <span class="s">&#39;parcellation_name&#39;</span><span class="p">,</span> <span class="s">&#39;aparc&#39;</span><span class="p">,</span> <span class="s">&#39;n_rot&#39;</span><span class="p">,</span> <span class="c">...</span>
                                   <span class="mi">1000</span><span class="p">,</span> <span class="s">&#39;type&#39;</span><span class="p">,</span> <span class="s">&#39;pearson&#39;</span><span class="p">);</span>
<span class="p">[</span><span class="n">sc_ctx_p</span><span class="p">,</span> <span class="n">sc_ctx_d</span><span class="p">]</span>   <span class="p">=</span> <span class="n">spin_test</span><span class="p">(</span><span class="n">sc_ctx_dc</span><span class="p">,</span> <span class="n">CT_z_mean</span><span class="p">{:,</span> <span class="p">:},</span> <span class="s">&#39;surface_name&#39;</span><span class="p">,</span> <span class="c">...</span>
                                   <span class="s">&#39;fsa5&#39;</span><span class="p">,</span> <span class="s">&#39;parcellation_name&#39;</span><span class="p">,</span> <span class="s">&#39;aparc&#39;</span><span class="p">,</span> <span class="s">&#39;n_rot&#39;</span><span class="p">,</span> <span class="c">...</span>
                                   <span class="mi">1000</span><span class="p">,</span> <span class="s">&#39;type&#39;</span><span class="p">,</span> <span class="s">&#39;pearson&#39;</span><span class="p">);</span>

<span class="c">% Shuf permutation testing for two subcortical maps</span>
<span class="p">[</span><span class="n">fc_sctx_p</span><span class="p">,</span> <span class="n">fc_sctx_d</span><span class="p">]</span> <span class="p">=</span> <span class="n">shuf_test</span><span class="p">(</span><span class="n">fc_sctx_dc</span><span class="p">,</span> <span class="n">SV_z_mean_noVent</span><span class="p">{:,</span> <span class="p">:},</span> <span class="c">...</span>
                                   <span class="s">&#39;n_rot&#39;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="s">&#39;type&#39;</span><span class="p">,</span> <span class="s">&#39;pearson&#39;</span><span class="p">);</span>
<span class="p">[</span><span class="n">sc_sctx_p</span><span class="p">,</span> <span class="n">sc_sctx_d</span><span class="p">]</span> <span class="p">=</span> <span class="n">shuf_test</span><span class="p">(</span><span class="n">sc_sctx_dc</span><span class="p">,</span> <span class="n">SV_z_mean_noVent</span><span class="p">{:,</span> <span class="p">:},</span> <span class="c">...</span>
                                   <span class="s">&#39;n_rot&#39;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="s">&#39;type&#39;</span><span class="p">,</span> <span class="s">&#39;pearson&#39;</span><span class="p">);</span>

<span class="c">% Store p-values and null distributions</span>
<span class="n">p_and_d</span> <span class="p">=</span>  <span class="n">cell2struct</span><span class="p">({[</span><span class="n">fc_ctx_p</span><span class="p">;</span> <span class="n">fc_ctx_d</span><span class="p">],</span> <span class="p">[</span><span class="n">fc_sctx_p</span><span class="p">;</span> <span class="n">fc_sctx_d</span><span class="p">],</span> <span class="p">[</span><span class="n">sc_ctx_p</span><span class="p">;</span> <span class="n">sc_ctx_d</span><span class="p">],</span> <span class="p">[</span><span class="n">sc_sctx_p</span><span class="p">;</span> <span class="n">sc_sctx_d</span><span class="p">]},</span> <span class="c">...</span>
                       <span class="p">{</span><span class="s">&#39;functional_cortical_hubs&#39;</span><span class="p">,</span> <span class="s">&#39;functional_subcortical_hubs&#39;</span><span class="p">,</span> <span class="c">...</span>
                        <span class="s">&#39;structural_cortical_hubs&#39;</span><span class="p">,</span> <span class="s">&#39;structural_subcortical_hubs&#39;</span><span class="p">},</span> <span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>To better interpret statistical significance, we can plot the null distribution of generated correlations
(<em>i.e.</em>, “spun” or “shuffled” correlations) and overlay the correlation coefficient obtained from the empirical
(<em>i.e.</em>, real) brain maps.</p>
<div class="sphinx-tabs docutils container">
<div class="ui top attached tabular menu sphinx-menu docutils container">
<div class="active item sphinx-data-tab-UHl0aG9u docutils container">
<div class="docutils container">
<p>Python</p>
</div>
</div>
<div class="item sphinx-data-tab-TWF0bGFi docutils container">
<div class="docutils container">
<p>Matlab</p>
</div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment code-tab sphinx-data-tab-UHl0aG9u active docutils container">
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">dd</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">p_and_d</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1"># Define plot colors</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">if</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">col</span> <span class="o">=</span> <span class="s1">&#39;#A8221C&#39;</span>     <span class="c1"># red for functional hubs</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">col</span> <span class="o">=</span> <span class="s1">&#39;#324F7D&#39;</span>     <span class="c1"># blue for structural hubs</span>

<span class="gp">&gt;&gt;&gt; </span>    <span class="c1"># Plot null distributions</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">dd</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">rvals</span><span class="p">[</span><span class="n">fn</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">dashes</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
<span class="gp">... </span>                   <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$r$=</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rvals</span><span class="p">[</span><span class="n">fn</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">$p$=</span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dd</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Null correlations </span><span class="se">\n</span><span class="s1"> (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fn</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment code-tab sphinx-data-tab-TWF0bGFi docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="p">=</span> <span class="n">figure</span><span class="p">,</span>
    <span class="n">set</span><span class="p">(</span><span class="n">gcf</span><span class="p">,</span><span class="s">&#39;color&#39;</span><span class="p">,</span><span class="s">&#39;w&#39;</span><span class="p">);</span>
    <span class="n">set</span><span class="p">(</span><span class="n">gcf</span><span class="p">,</span><span class="s">&#39;units&#39;</span><span class="p">,</span><span class="s">&#39;normalized&#39;</span><span class="p">,</span><span class="s">&#39;position&#39;</span><span class="p">,[</span><span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mf">0.3</span><span class="p">])</span>
    <span class="n">fns</span> <span class="p">=</span> <span class="n">fieldnames</span><span class="p">(</span><span class="n">p_and_d</span><span class="p">);</span>

    <span class="n">for</span> <span class="s">k</span> <span class="s">=</span> <span class="s">1:numel(fieldnames(rvals))</span>
        <span class="c">% Define plot colors</span>
        <span class="n">if</span> <span class="s">k</span> <span class="s">&lt;=</span> <span class="s">2</span><span class="p">;</span> <span class="n">col</span> <span class="p">=</span> <span class="p">[</span><span class="mf">0.66</span> <span class="mf">0.13</span> <span class="mf">0.11</span><span class="p">];</span> <span class="k">else</span><span class="p">;</span> <span class="n">col</span> <span class="p">=</span> <span class="p">[</span><span class="mf">0.2</span> <span class="mf">0.33</span> <span class="mf">0.49</span><span class="p">];</span> <span class="n">end</span>

        <span class="s">%</span> <span class="s">Plot</span> <span class="s">null</span> <span class="s">distributions</span>
        <span class="n">axs</span> <span class="p">=</span> <span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">k</span><span class="p">);</span> <span class="n">hold</span> <span class="s">on</span>
        <span class="n">h</span> <span class="p">=</span> <span class="n">histogram</span><span class="p">(</span><span class="n">p_and_d</span><span class="p">.(</span><span class="n">fns</span><span class="p">{</span><span class="n">k</span><span class="p">})(</span><span class="mi">2</span><span class="p">:</span><span class="k">end</span><span class="p">),</span> <span class="mi">50</span><span class="p">,</span> <span class="s">&#39;Normalization&#39;</span><span class="p">,</span> <span class="s">&#39;pdf&#39;</span><span class="p">,</span> <span class="s">&#39;edgecolor&#39;</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">,</span> <span class="c">...</span>
                      <span class="s">&#39;facecolor&#39;</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="s">&#39;facealpha&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;linewidth&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">);</span>
        <span class="n">l</span> <span class="p">=</span> <span class="n">line</span><span class="p">([</span><span class="n">rvals</span><span class="p">.(</span><span class="n">fns</span><span class="p">{</span><span class="n">k</span><span class="p">})</span> <span class="n">rvals</span><span class="p">.(</span><span class="n">fns</span><span class="p">{</span><span class="n">k</span><span class="p">})],</span> <span class="n">get</span><span class="p">(</span><span class="n">gca</span><span class="p">,</span> <span class="s">&#39;ylim&#39;</span><span class="p">),</span> <span class="s">&#39;linestyle&#39;</span><span class="p">,</span> <span class="s">&#39;--&#39;</span><span class="p">,</span> <span class="c">...</span>
                 <span class="s">&#39;color&#39;</span><span class="p">,</span> <span class="s">&#39;k&#39;</span><span class="p">,</span> <span class="s">&#39;linewidth&#39;</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">);</span>
        <span class="n">xlabel</span><span class="p">([</span><span class="s">&#39;Null correlations&#39;</span> <span class="n">newline</span> <span class="s">&#39;(&#39;</span> <span class="n">strrep</span><span class="p">(</span><span class="n">fns</span><span class="p">{</span><span class="n">k</span><span class="p">},</span> <span class="s">&#39;_&#39;</span><span class="p">,</span> <span class="s">&#39; &#39;</span><span class="p">)</span> <span class="s">&#39;)&#39;</span><span class="p">])</span>
        <span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Density&#39;</span><span class="p">)</span>
        <span class="n">legend</span><span class="p">(</span><span class="n">l</span><span class="p">,[</span><span class="s">&#39;{\it r}=&#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">rvals</span><span class="p">.(</span><span class="n">fns</span><span class="p">{</span><span class="n">k</span><span class="p">}),</span> <span class="mi">2</span><span class="p">))</span> <span class="n">newline</span> <span class="c">...</span>
                  <span class="s">&#39;{\it p}=&#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">p_and_d</span><span class="p">.(</span><span class="n">fns</span><span class="p">{</span><span class="n">k</span><span class="p">})(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">3</span><span class="p">))])</span>
        <span class="n">legend</span> <span class="s">boxoff</span>
    <span class="n">end</span>
</pre></div>
</div>
</div>
</div>
<img alt="../../_images/nulldist.png" class="align-center" src="../../_images/nulldist.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="plot-hub-atrophy-correlations">
<h2>Plot hub-atrophy correlations<a class="headerlink" href="#plot-hub-atrophy-correlations" title="Permalink to this headline">¶</a></h2>
<p>Now that we have done all the necessary analyses, we can finally display our correlations!
Here, a negative correlation indicates that greater atrophy correlates
with the spatial distribution of hub regions (greater degree centrality).</p>
<pre class="literal-block"><strong>Prerequisites</strong>
     The script below can be used to show relationships between any two variables, as for example:
     degree centrality <em>vs</em>. atrophy
          ↪ Load <a class="reference internal" href="../04.loadsumstats/index.html#load-sumstats"><span class="std std-ref">summary statistics</span></a> <strong>or</strong> <a class="reference internal" href="../03.loadct/index.html#load-example-data"><span class="std std-ref">example data</span></a>
          ↪ <a class="reference internal" href="../03.loadct/index.html#reorder-sctx"><span class="std std-ref">Re-order subcortical data</span></a> (<em>mega only</em>)
          ↪ <a class="reference internal" href="../03.loadct/index.html#zscore-data"><span class="std std-ref">Z-score data</span></a> (<em>mega only</em>)
          ↪ Load <a class="reference internal" href="../05.HCP/index.html#load-corticocortical"><span class="std std-ref">cortico-cortical</span></a> and <a class="reference internal" href="../05.HCP/index.html#load-subcorticocortical"><span class="std std-ref">subcortico-cortical</span></a> connectivity matrices
          ↪ Compute <a class="reference internal" href="#cortical-hubs"><span class="std std-ref">cortical-cortical</span></a> and <a class="reference internal" href="#subcortical-hubs"><span class="std std-ref">subcortico-cortical</span></a> degree centrality
          ↪ Assess statistical significance via <a class="reference internal" href="#spin-perm"><span class="std std-ref">spin permutation tests</span></a></pre>
<div class="sphinx-tabs docutils container">
<div class="ui top attached tabular menu sphinx-menu docutils container">
<div class="active item sphinx-data-tab-KipQeXRob24qKiB8IG1ldGE= docutils container">
<div class="docutils container">
<p><strong>Python</strong> | meta</p>
</div>
</div>
<div class="item sphinx-data-tab-KipNYXRsYWIqKiB8IG1ldGE= docutils container">
<div class="docutils container">
<p><strong>Matlab</strong> | meta</p>
</div>
</div>
<div class="item sphinx-data-tab-5-0 docutils container">
<div class="docutils container">
<p>⤎ ⤏</p>
</div>
</div>
<div class="item sphinx-data-tab-KipQeXRob24qKiB8IG1lZ2E= docutils container">
<div class="docutils container">
<p><strong>Python</strong> | mega</p>
</div>
</div>
<div class="item sphinx-data-tab-KipNYXRsYWIqKiB8IG1lZ2E= docutils container">
<div class="docutils container">
<p><strong>Matlab</strong> | mega</p>
</div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment code-tab sphinx-data-tab-KipQeXRob24qKiB8IG1ldGE= active docutils container">
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Store degree centrality and atrophy measures</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meas</span> <span class="o">=</span> <span class="p">{(</span><span class="s1">&#39;functional cortical hubs&#39;</span><span class="p">,</span> <span class="s1">&#39;cortical thickness&#39;</span><span class="p">):</span> <span class="p">[</span><span class="n">fc_ctx_dc</span><span class="p">,</span> <span class="n">CT_d</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">(</span><span class="s1">&#39;functional subcortical hubs&#39;</span><span class="p">,</span> <span class="s1">&#39;subcortical volume&#39;</span><span class="p">):</span> <span class="p">[</span><span class="n">fc_sctx_dc</span><span class="p">,</span> <span class="n">SV_d_noVent</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">(</span><span class="s1">&#39;structural cortical hubs&#39;</span><span class="p">,</span> <span class="s1">&#39;cortical thickness&#39;</span><span class="p">):</span> <span class="p">[</span><span class="n">sc_ctx_dc</span><span class="p">,</span> <span class="n">CT_d</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">(</span><span class="s1">&#39;structural subcortical hubs&#39;</span><span class="p">,</span> <span class="s1">&#39;subcortical volume&#39;</span><span class="p">):</span> <span class="p">[</span><span class="n">sc_sctx_dc</span><span class="p">,</span> <span class="n">SV_d_noVent</span><span class="p">]}</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">dd</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">meas</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1"># Define scatter colors</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">if</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">col</span> <span class="o">=</span> <span class="s1">&#39;#A8221C&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">col</span> <span class="o">=</span> <span class="s1">&#39;#324F7D&#39;</span>

<span class="gp">&gt;&gt;&gt; </span>    <span class="c1"># Plot relationships between hubs and atrophy</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">meas</span><span class="p">[</span><span class="n">fn</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">meas</span><span class="p">[</span><span class="n">fn</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">col</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$r$=</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rvals</span><span class="p">[</span><span class="n">fn</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">$p$=</span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p_and_d</span><span class="p">[</span><span class="n">fn</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">0</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">m</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">meas</span><span class="p">[</span><span class="n">fn</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">meas</span><span class="p">[</span><span class="n">fn</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">meas</span><span class="p">[</span><span class="n">fn</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">m</span> <span class="o">*</span> <span class="n">meas</span><span class="p">[</span><span class="n">fn</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">col</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fn</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment code-tab sphinx-data-tab-KipNYXRsYWIqKiB8IG1ldGE= docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Store degree centrality measures</span>
<span class="n">meas</span>  <span class="s">=</span>  <span class="s">cell2struct({fc_ctx_dc.&#39;, fc_sctx_dc, sc_ctx_dc.&#39;,</span> <span class="s">sc_sctx_dc},</span> <span class="s">...</span>
                     <span class="p">{</span><span class="s">&#39;Functional_cortical_hubs&#39;</span><span class="p">,</span> <span class="s">&#39;Functional_subcortical_hubs&#39;</span><span class="p">,</span> <span class="c">...</span>
                     <span class="s">&#39;Structural_cortical_hubs&#39;</span><span class="p">,</span> <span class="s">&#39;Structural_subcortical_hubs&#39;</span><span class="p">},</span> <span class="mi">2</span><span class="p">);</span>
<span class="n">fns</span>   <span class="s">=</span> <span class="s">fieldnames(meas)</span><span class="p">;</span>

<span class="c">% Store atrophy measures</span>
<span class="n">meas2</span> <span class="p">=</span>  <span class="n">cell2struct</span><span class="p">({</span><span class="n">CT_d</span><span class="p">,</span> <span class="n">SV_d_noVent</span><span class="p">},</span> <span class="p">{</span><span class="s">&#39;Cortical_thickness&#39;</span><span class="p">,</span> <span class="s">&#39;Subcortical_volume&#39;</span><span class="p">},</span> <span class="mi">2</span><span class="p">);</span>
<span class="n">fns2</span>  <span class="s">=</span> <span class="s">fieldnames(meas2)</span><span class="p">;</span>

<span class="n">f</span> <span class="p">=</span> <span class="n">figure</span><span class="p">,</span>
    <span class="n">set</span><span class="p">(</span><span class="n">gcf</span><span class="p">,</span><span class="s">&#39;color&#39;</span><span class="p">,</span><span class="s">&#39;w&#39;</span><span class="p">);</span>
    <span class="n">set</span><span class="p">(</span><span class="n">gcf</span><span class="p">,</span><span class="s">&#39;units&#39;</span><span class="p">,</span><span class="s">&#39;normalized&#39;</span><span class="p">,</span><span class="s">&#39;position&#39;</span><span class="p">,[</span><span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mf">0.3</span><span class="p">])</span>
    <span class="n">k2</span> <span class="p">=</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">1</span> <span class="mi">2</span><span class="p">];</span>

    <span class="n">for</span> <span class="s">k</span> <span class="s">=</span> <span class="s">1:numel(fieldnames(meas))</span>
        <span class="nb">j</span> <span class="p">=</span> <span class="n">k2</span><span class="p">(</span><span class="n">k</span><span class="p">);</span>

        <span class="c">% Define plot colors</span>
        <span class="n">if</span> <span class="s">k</span> <span class="s">&lt;=</span> <span class="s">2</span><span class="p">;</span> <span class="n">col</span> <span class="p">=</span> <span class="p">[</span><span class="mf">0.66</span> <span class="mf">0.13</span> <span class="mf">0.11</span><span class="p">];</span> <span class="k">else</span><span class="p">;</span> <span class="n">col</span> <span class="p">=</span> <span class="p">[</span><span class="mf">0.2</span> <span class="mf">0.33</span> <span class="mf">0.49</span><span class="p">];</span> <span class="n">end</span>

        <span class="s">%</span> <span class="s">Plot</span> <span class="s">relationships</span> <span class="s">between</span> <span class="s">hubs</span> <span class="s">and</span> <span class="s">atrophy</span>
        <span class="n">axs</span> <span class="p">=</span> <span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">k</span><span class="p">);</span> <span class="n">hold</span> <span class="s">on</span>
        <span class="n">s</span>   <span class="s">=</span> <span class="s">scatter(meas.(fns{k}),</span> <span class="s">meas2.(fns2{j}),</span> <span class="s">88,</span> <span class="s">col,</span> <span class="s">&#39;filled&#39;)</span><span class="p">;</span>
        <span class="n">P1</span>      <span class="s">=</span> <span class="s">polyfit(meas.(fns{k}),</span> <span class="s">meas2.(fns2{j}),</span> <span class="s">1)</span><span class="p">;</span>
        <span class="n">yfit_1</span>  <span class="s">=</span> <span class="s">P1(1)</span> <span class="s">*</span> <span class="s">meas.(fns{k})</span> <span class="s">+</span> <span class="s">P1(2)</span><span class="p">;</span>
        <span class="n">plot</span><span class="p">(</span><span class="n">meas</span><span class="p">.(</span><span class="n">fns</span><span class="p">{</span><span class="n">k</span><span class="p">}),</span> <span class="n">yfit_1</span><span class="p">,</span> <span class="s">&#39;color&#39;</span><span class="p">,</span><span class="n">col</span><span class="p">,</span> <span class="s">&#39;LineWidth&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span> <span class="mf">0.5</span><span class="p">])</span>
        <span class="n">xlabel</span><span class="p">(</span><span class="n">strrep</span><span class="p">(</span><span class="n">fns</span><span class="p">{</span><span class="n">k</span><span class="p">},</span> <span class="s">&#39;_&#39;</span><span class="p">,</span> <span class="s">&#39; &#39;</span><span class="p">))</span>
        <span class="n">ylabel</span><span class="p">(</span><span class="n">strrep</span><span class="p">(</span><span class="n">fns2</span><span class="p">{</span><span class="nb">j</span><span class="p">},</span> <span class="s">&#39;_&#39;</span><span class="p">,</span> <span class="s">&#39; &#39;</span><span class="p">))</span>
        <span class="n">legend</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;{\it r}=&#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">rvals</span><span class="p">.(</span><span class="n">lower</span><span class="p">(</span><span class="n">fns</span><span class="p">{</span><span class="n">k</span><span class="p">})),</span> <span class="mi">2</span><span class="p">))</span> <span class="n">newline</span> <span class="c">...</span>
                  <span class="s">&#39;{\it p}=&#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">p_and_d</span><span class="p">.(</span><span class="n">lower</span><span class="p">(</span><span class="n">fns</span><span class="p">{</span><span class="n">k</span><span class="p">}))(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">3</span><span class="p">))])</span>
        <span class="n">legend</span> <span class="s">boxoff</span>
    <span class="n">end</span>
</pre></div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment sphinx-data-tab-5-0 docutils container">
<div class="line-block">
<div class="line">⤎ If you have <strong>meta</strong>-analysis data (<em>e.g.</em>, summary statistics)</div>
<div class="line">⤏ If you have individual site or <strong>mega</strong>-analysis data</div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment code-tab sphinx-data-tab-KipQeXRob24qKiB8IG1lZ2E= docutils container">
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Store degree centrality and atrophy measures</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meas</span> <span class="o">=</span> <span class="p">{(</span><span class="s1">&#39;functional cortical hubs&#39;</span><span class="p">,</span> <span class="s1">&#39;cortical thickness&#39;</span><span class="p">):</span> <span class="p">[</span><span class="n">fc_ctx_dc</span><span class="p">,</span> <span class="n">CT_z_mean</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">(</span><span class="s1">&#39;functional subcortical hubs&#39;</span><span class="p">,</span> <span class="s1">&#39;subcortical volume&#39;</span><span class="p">):</span> <span class="p">[</span><span class="n">fc_sctx_dc</span><span class="p">,</span> <span class="n">SV_z_mean_noVent</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">(</span><span class="s1">&#39;structural cortical hubs&#39;</span><span class="p">,</span> <span class="s1">&#39;cortical thickness&#39;</span><span class="p">):</span> <span class="p">[</span><span class="n">sc_ctx_dc</span><span class="p">,</span> <span class="n">CT_z_mean</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">(</span><span class="s1">&#39;structural subcortical hubs&#39;</span><span class="p">,</span> <span class="s1">&#39;subcortical volume&#39;</span><span class="p">):</span> <span class="p">[</span><span class="n">sc_sctx_dc</span><span class="p">,</span> <span class="n">SV_z_mean_noVent</span><span class="p">]}</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">dd</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">meas</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1"># Define scatter colors</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">if</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">col</span> <span class="o">=</span> <span class="s1">&#39;#A8221C&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">col</span> <span class="o">=</span> <span class="s1">&#39;#324F7D&#39;</span>

<span class="gp">&gt;&gt;&gt; </span>    <span class="c1"># Plot relationships between hubs and atrophy</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">meas</span><span class="p">[</span><span class="n">fn</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">meas</span><span class="p">[</span><span class="n">fn</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">col</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$r$=</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rvals</span><span class="p">[</span><span class="n">fn</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">$p$=</span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p_and_d</span><span class="p">[</span><span class="n">fn</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">0</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">m</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">meas</span><span class="p">[</span><span class="n">fn</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">meas</span><span class="p">[</span><span class="n">fn</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">meas</span><span class="p">[</span><span class="n">fn</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">m</span> <span class="o">*</span> <span class="n">meas</span><span class="p">[</span><span class="n">fn</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">col</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="o">-</span><span class="mf">3.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fn</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment code-tab sphinx-data-tab-KipNYXRsYWIqKiB8IG1lZ2E= docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Store degree centrality measures</span>
<span class="n">meas</span>  <span class="s">=</span>  <span class="s">cell2struct({fc_ctx_dc,</span> <span class="s">fc_sctx_dc.&#39;, sc_ctx_dc, sc_sctx_dc.&#39;},</span> <span class="s">...</span>
                     <span class="p">{</span><span class="s">&#39;Functional_cortical_hubs&#39;</span><span class="p">,</span> <span class="s">&#39;Functional_subcortical_hubs&#39;</span><span class="p">,</span> <span class="c">...</span>
             <span class="s">&#39;Structural_cortical_hubs&#39;</span><span class="p">,</span> <span class="s">&#39;Structural_subcortical_hubs&#39;</span><span class="p">},</span> <span class="mi">2</span><span class="p">);</span>
<span class="n">fns</span>   <span class="s">=</span> <span class="s">fieldnames(meas)</span><span class="p">;</span>

<span class="c">% Store atrophy measures</span>
<span class="n">meas2</span> <span class="p">=</span>  <span class="n">cell2struct</span><span class="p">({</span><span class="n">CT_z_mean</span><span class="p">{:,</span> <span class="p">:},</span> <span class="n">SV_z_mean_noVent</span><span class="p">{:,</span> <span class="p">:}},</span> <span class="c">...</span>
                     <span class="p">{</span><span class="s">&#39;Cortical_thickness&#39;</span><span class="p">,</span> <span class="s">&#39;Subcortical_volume&#39;</span><span class="p">},</span> <span class="mi">2</span><span class="p">);</span>
<span class="n">fns2</span>  <span class="s">=</span> <span class="s">fieldnames(meas2)</span><span class="p">;</span>

<span class="n">f</span> <span class="p">=</span> <span class="n">figure</span><span class="p">,</span>
    <span class="n">set</span><span class="p">(</span><span class="n">gcf</span><span class="p">,</span><span class="s">&#39;color&#39;</span><span class="p">,</span><span class="s">&#39;w&#39;</span><span class="p">);</span>
    <span class="n">set</span><span class="p">(</span><span class="n">gcf</span><span class="p">,</span><span class="s">&#39;units&#39;</span><span class="p">,</span><span class="s">&#39;normalized&#39;</span><span class="p">,</span><span class="s">&#39;position&#39;</span><span class="p">,[</span><span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mf">0.3</span><span class="p">])</span>
    <span class="n">k2</span> <span class="p">=</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">1</span> <span class="mi">2</span><span class="p">];</span>

    <span class="n">for</span> <span class="s">k</span> <span class="s">=</span> <span class="s">1:numel(fieldnames(meas))</span>
        <span class="nb">j</span> <span class="p">=</span> <span class="n">k2</span><span class="p">(</span><span class="n">k</span><span class="p">);</span>

        <span class="c">% Define plot colors</span>
        <span class="n">if</span> <span class="s">k</span> <span class="s">&lt;=</span> <span class="s">2</span><span class="p">;</span> <span class="n">col</span> <span class="p">=</span> <span class="p">[</span><span class="mf">0.66</span> <span class="mf">0.13</span> <span class="mf">0.11</span><span class="p">];</span> <span class="k">else</span><span class="p">;</span> <span class="n">col</span> <span class="p">=</span> <span class="p">[</span><span class="mf">0.2</span> <span class="mf">0.33</span> <span class="mf">0.49</span><span class="p">];</span> <span class="n">end</span>

        <span class="s">%</span> <span class="s">Plot</span> <span class="s">relationships</span> <span class="s">between</span> <span class="s">hubs</span> <span class="s">and</span> <span class="s">atrophy</span>
        <span class="n">axs</span> <span class="p">=</span> <span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">k</span><span class="p">);</span> <span class="n">hold</span> <span class="s">on</span>
        <span class="n">s</span>   <span class="s">=</span> <span class="s">scatter(meas.(fns{k}),</span> <span class="s">meas2.(fns2{j}),</span> <span class="s">88,</span> <span class="s">col,</span> <span class="s">&#39;filled&#39;)</span><span class="p">;</span>
        <span class="n">P1</span>      <span class="s">=</span> <span class="s">polyfit(meas.(fns{k}),</span> <span class="s">meas2.(fns2{j}),</span> <span class="s">1)</span><span class="p">;</span>
        <span class="n">yfit_1</span>  <span class="s">=</span> <span class="s">P1(1)</span> <span class="s">*</span> <span class="s">meas.(fns{k})</span> <span class="s">+</span> <span class="s">P1(2)</span><span class="p">;</span>
        <span class="n">plot</span><span class="p">(</span><span class="n">meas</span><span class="p">.(</span><span class="n">fns</span><span class="p">{</span><span class="n">k</span><span class="p">}),</span> <span class="n">yfit_1</span><span class="p">,</span> <span class="s">&#39;color&#39;</span><span class="p">,</span><span class="n">col</span><span class="p">,</span> <span class="s">&#39;LineWidth&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">3</span> <span class="mf">1.5</span><span class="p">])</span>
        <span class="n">xlabel</span><span class="p">(</span><span class="n">strrep</span><span class="p">(</span><span class="n">fns</span><span class="p">{</span><span class="n">k</span><span class="p">},</span> <span class="s">&#39;_&#39;</span><span class="p">,</span> <span class="s">&#39; &#39;</span><span class="p">))</span>
        <span class="n">ylabel</span><span class="p">(</span><span class="n">strrep</span><span class="p">(</span><span class="n">fns2</span><span class="p">{</span><span class="nb">j</span><span class="p">},</span> <span class="s">&#39;_&#39;</span><span class="p">,</span> <span class="s">&#39; &#39;</span><span class="p">))</span>
        <span class="n">legend</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;{\it r}=&#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">rvals</span><span class="p">.(</span><span class="n">lower</span><span class="p">(</span><span class="n">fns</span><span class="p">{</span><span class="n">k</span><span class="p">})),</span> <span class="mi">2</span><span class="p">))</span> <span class="n">newline</span> <span class="c">...</span>
                  <span class="s">&#39;{\it p}=&#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">p_and_d</span><span class="p">.(</span><span class="n">lower</span><span class="p">(</span><span class="n">fns</span><span class="p">{</span><span class="n">k</span><span class="p">}))(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">3</span><span class="p">))])</span>
        <span class="n">legend</span> <span class="s">boxoff</span>
    <span class="n">end</span>
</pre></div>
</div>
</div>
</div>
<img alt="../../_images/scatter.png" class="align-center" src="../../_images/scatter.png" />
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../07.epicenter/index.html" class="btn btn-neutral float-right" title="Epicenter mapping" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../05.HCP/index.html" class="btn btn-neutral float-left" title="Connectivity data" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, enigmators

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a 
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a> and modified by @saratheriver 🤠 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    

  <style>
         .wy-nav-content { max-width: none; }
  </style>


  <footer>
    
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a 
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. Modified by @saratheriver 🤠 

  </footer>



</body>
</html>